# 1.WINRMå’ŒWIMRS

Windows è¿œç¨‹ç®¡ç†

 ## 1.1 WINRM

**Windowsè¿œç¨‹ç®¡ç†ï¼ˆWinRMï¼‰æ˜¯Windows Server 2003 R2, Windows Vistaå’ŒWindows Server 2008ä¸­ä¸€ç§æ–°å¼çš„æ–¹ä¾¿**è¿œç¨‹ç®¡ç†**çš„æœåŠ¡ã€‚**

*WinRMæ˜¯è¿œç¨‹ç®¡ç†åº”ç”¨çš„â€œæœåŠ¡å™¨â€ç»„æˆéƒ¨åˆ†ï¼Œå¹¶ä¸”WinRSï¼ˆWindowsè¿œç¨‹Shellï¼‰æ˜¯WinRMçš„â€œå®¢æˆ·ç«¯â€ï¼Œå®ƒåœ¨è¿œç¨‹ç®¡ç†WinRMæœåŠ¡å™¨çš„è®¡ç®—æœºä¸Šè¿è¡Œã€‚  ç„¶è€Œï¼Œæˆ‘ä»¬åº”è¯¥æ³¨æ„åˆ°ä¸¤ä¸ªè®¡ç®—æœºå¿…é¡»æ‰‹åŠ¨å®‰è£…WinRSï¼Œè¿˜è¦ä½¿WinRMèƒ½å¤Ÿå¯åŠ¨å¹¶ä»è¿œç¨‹ç³»ç»Ÿä¼ å›ä¿¡æ¯ã€‚*

**ä½¿ç”¨httpåŠSOAPåè®®å®Œæˆå·¥ä½œï¼›å¾ˆå®¹æ˜“å®Œæˆhttpè¯·æ±‚ï¼Œä¹Ÿå¾ˆå®¹æ˜“è¢«æ”»å‡»è€…åˆ©ç”¨æ¥åšè¿œç¨‹ç®¡ç†ï¼**

  *WinRMåŸºäºWebæœåŠ¡ç®¡ç†ï¼ˆWS-Managementï¼‰æ ‡å‡†ã€‚ è¿™ä¹ˆè¯´çš„æ„æ€æ˜¯ï¼šWinRMä½¿ç”¨HTTP[åè®®](http://cisco.chinaitlab.com/List_11.html)ï¼ˆ80ç«¯å£ï¼‰å¹¶ä¸”ç”¨SOAPæ¥è¯·æ±‚å®ƒå·¥ä½œã€‚ è¿™æ ·çš„å¥½å¤„åœ¨äºHTTPè¯·æ±‚èƒ½å¤Ÿéå¸¸å®¹æ˜“çš„ç©¿è¿‡[é˜²ç«å¢™](http://security.chinaitlab.com/List_1291.html)è¿›è¡Œæ”¶å‘ã€‚ å› è€Œå®ƒçš„å¥½ååœ¨äºï¼šå®ƒä½¿é€šè¿‡Internetç®¡ç†è¿œç¨‹Windows PCæ›´ä¸ºå®¹æ˜“ï¼Œæˆ–è€…å®ƒæ›´å®¹æ˜“é€‚åˆInternetä¸Šå­˜å¿ƒä¸è‰¯çš„è¿œç¨‹Windowsæ”»å‡»è€…ã€‚ WinRMä½¿ç”¨HTTPçš„å…¶å®ƒå¥½å¤„åœ¨äºï¼šå¦‚æœHTTPå…¥ç«™é€šè®¯è¢«å…è®¸ï¼Œå°±æ²¡æœ‰å…¶å®ƒç«¯å£å¿…éœ€åœ¨æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¸Šè¢«å¼€æ”¾ã€‚*



**ä½¿ç”¨WMIæ•°æ®åº“æ‰§è¡ŒæŒ‡ä»¤ï¼›ä½¿ç”¨80 ç«¯å£ï¼Œç”šè‡³å¯å’ŒIISå…±åŒä½¿ç”¨80ç«¯å£ã€‚**

*WinRMå°†ä½¿ç”¨WMIæ•°æ®åº“æ‰§è¡Œä½ æˆ–è€…ä½ çš„ç³»ç»Ÿç®¡ç†åŒ…çš„ä»»åŠ¡ï¼Œå°±åƒä½¿ç”¨VBScriptä¸€æ ·ä½¿ç”¨å¦ä¸€ä¸ªç¼–ç¨‹æ¥å£çš„ç›¸ä¼¼ä»»åŠ¡ã€‚ä¸æˆ‘åœ¨å‰é¢æåŠæ—¶ç›¸åŒï¼ŒWinRMçš„å¥½å¤„æ˜¯å®ƒä½¿ç”¨80ç«¯å£ï¼ˆHTTPï¼‰ã€‚å¹¶ä¸”æœ‰äº›ç‰¹æ®Šçš„ä»£ç ç”šè‡³å…è®¸WinRMä¸IISå…±äº«80å…¥ç«™ç«¯å£ï¼Œå®ƒä»¬å¯èƒ½æ­£å…±åŒè¿è¡Œåœ¨80ç«¯å£ä¸Šã€‚*



**å¯ä¸ºå…¶æ·»åŠ éªŒè¯æ¥åšå®‰å…¨é˜²èŒƒã€‚**

  *WinRMæ”¯æŒå¤šç§éªŒè¯æ–¹å¼ï¼Œä»¥é˜»æ­¢æ­£è¿æ¥ä¸Šçš„ä»»ä½•äººè¿›è¡Œä»»ä½•å…³äºä½ PCå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„ç®¡ç†ä»»åŠ¡ã€‚ä¸è¿‡ï¼Œå¦‚åŒè¢«å¼€æ”¾çš„å…¶ä»–ä»»ä½•ç«¯å£ä¸€æ ·ï¼Œå¦‚æœéªŒè¯å’ŒåŠ å¯†è¢«æ”¾ç½®åœ¨äº†åˆé€‚çš„æ—¶æœºï¼Œä½ å°±å·²ç»é‡‡å–äº†å…¨éƒ¨åˆç†çš„[å®‰å…¨](http://security.chinaitlab.com/)é˜²èŒƒã€‚*

åˆ¤æ–­æ˜¯å¦ğŸ”›

  winrm enumerate winrm/config/listener





## 1.2 WinRS
â€‹	WinRSæ˜¯Windowsè¿œç¨‹Shellã€‚ 

â€‹	ä½¿ç”¨WinRSä½ å¯ä»¥æŸ¥è¯¢è¿œç¨‹è¿è¡ŒWinRMçš„Windowsä¸»æœºã€‚ä¸è¿‡è¯·è®°ä½ï¼Œä½ çš„ä¸»æœºä¹Ÿéœ€è¦è¿è¡ŒWinRMæ¥ä½¿ç”¨WinRSã€‚
â€‹    å¦‚ä½ ä»ä¸‹é¢çš„å›¾è§£ä¸­çœ‹åˆ°çš„ä¸€æ ·ï¼Œwinrsæ˜¯ä¸€ä¸ªéå¸¸æœ‰ç‰¹è‰²ã€èƒ½å¤Ÿæä¾›ä¸°å¯Œå¸®åŠ©ä¿¡æ¯çš„å…¨å‘½ä»¤è¡Œå·¥å…·ã€‚

  

*WinRMå’ŒWinRSæ˜¯Windowsç³»ç»Ÿç®¡ç†å‘˜åº”è¯¥äº†è§£çš„éå¸¸å¼ºæœ‰åŠ›çš„æ–°å·¥å…·ã€‚  æˆ‘æƒ³ä½¿ç”¨WinRM/WinRSè¿›è¡Œè¿œç¨‹ç®¡ç†éå¸¸æœ‰æ½œåŠ›ï¼ ä½ å¯ä»¥å®‰è£…ç¨‹åºã€æ›´æ”¹è®¾ç½®æˆ–è€…Troubleshootingï¼ˆåªè¦å®ƒè¿åœ¨ç½‘ç»œä¸Šï¼‰ã€‚ ä½ ç”šè‡³èƒ½æ›´è¿›ä¸€æ­¥å»æ‰©å±•å®ƒå¹¶ä¸”æŠŠWinRSä¸è„šæœ¬ç»„åˆèµ·æ¥åœ¨è®¡ç®—æœºåˆ—è¡¨ä¸­æ‰§è¡Œé‚£äº›ä»»åŠ¡ã€‚ å¹¶ä¸”è¯·è®°ä½ï¼Œæ— è®ºä½ æ˜¯å¦ä½¿ç”¨è¿™äº›ä¸ªå·¥å…·ï¼Œä½ çš„ç³»ç»Ÿç®¡ç†è½¯ä»¶åœ¨ä¸ä¹…çš„å°†æ¥å…¨ç”¨åˆ°å®ƒä»¬ã€‚*

winrs ver 



## 1.3 winrshost

winrshost ---->cmd.exe





# 2.wce



# 3.vssadmin





# 4.wmic

https://www.freebuf.com/articles/system/182531.html



# PS:Winlogbeat

Winlogbeatæ˜¯Windowsäº‹ä»¶æ—¥å¿—çš„è½»é‡çº§æ•°æ®å‘é€å™¨ã€‚ è™½ç„¶Elasticç¾¤é›†é€šå¸¸ç”¨äºå®æ—¶ç›‘è§†ï¼Œä½†æ˜¯å¯ä»¥å¯¹Winlogbeatè¿›è¡Œè°ƒæ•´ï¼Œä»¥æ‰‹åŠ¨å°†â€œå†·æ—¥å¿—â€æˆ–æ—§çš„éæ´»åŠ¨Windowsäº‹ä»¶æ—¥å¿—ï¼ˆEVTXï¼‰æ‰‹åŠ¨å‘é€ç»™Elastic Stackã€‚ è¯¥åŠŸèƒ½ä½¿åˆ†æäººå‘˜å¯ä»¥ä»æ”¶é›†çš„ç³»ç»Ÿå›¾åƒä¸­æå–EVTXæ–‡ä»¶ï¼Œå¹¶åˆ©ç”¨Elasticå †æ ˆçš„åŠŸèƒ½è¿›è¡Œè°ƒæŸ¥ã€‚

ä½¿ç”¨Winlogbeatå°†Windowsäº‹ä»¶æ—¥å¿—æµä¼ è¾“åˆ°Elasticsearchã€‚Winlogbeat é€šè¿‡æ ‡å‡†çš„ windows API è·å– windows ç³»ç»Ÿæ—¥å¿—ï¼Œå¸¸è§çš„æœ‰ Applicationï¼ŒSecurity ã€Systemä¸‰ä¸ªæ ¸å¿ƒæ—¥å¿—æ–‡ä»¶ã€‚

https://cloud.tencent.com/developer/article/1539163Â·



4.schtasks

5.lsass

